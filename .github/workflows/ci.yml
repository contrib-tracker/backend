name: CI
on:
  push:
    branches:
      - cicdtest
    tags:
      - '*'
  pull_request:

# concurrency:
#   group: ${{ github.ref }}
#   cancel-in-progress: true

jobs:
  drupal_codequality:
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository code
        uses: actions/checkout@v4

      - name: Drupal Code Quality
        uses: hussainweb/drupalqa-action@v2
        id: drupalqa
        with:
          php-version: 8.2
          checks: |
            phplint: {}
            phpcs:
              standard: phpcs.xml
              ignore: /node_modules/
            phpmd:
              ruleset: phpmd.xml
              suffixes: php


  frontend_codequality:
    runs-on: ubuntu-latest
    container: node:lts
    steps:
      - name: Check out repository code
        uses: actions/checkout@v4

      - name: Frontend Code Quality
        run: |
          cd web/themes/custom/contribtracker
          npm ci
          npm run lint
